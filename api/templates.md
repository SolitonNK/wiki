# Templates and Pivots API

テンプレートとピボットには同じAPIがあります。このドキュメントはテンプレートAPIについて説明します。ピボットを管理するには、単にtemplatesURLをに置き換えますpivots。

テンプレートとピボットはGUIDによって参照されます。ユーザーがグローバルテンプレートと同じGUIDを使用してテンプレートまたはピボットをインストールすると、自分のものだけが透過的にグローバルテンプレートをオーバーライドします。同じGUIDを持つ複数のテンプレートまたはピボットが存在する場合、それらは次の順序で優先順位が付けられます。

* ユーザーが所有
* ユーザーがメンバーになっているグループと共有
* グローバル

## テンプレートを作成する

テンプレートを作成するには、にPOSTを実行し/api/templatesます。本体は、任意の有効なJSON、およびオプションでGUID、Name、Descrptionを含む 'Contents'フィールドを持つJSON構造にする必要があります。以下はすべて有効です。

```
{"Contents": "foo"}
```

```
{"GUID":"ce95b152-d47f-443f-884b-e0b506a215be","Contents":{"a":1, "b":2}}
```

```
{"Contents": "foo","Name":"mytemplate"}
```

```
{"GUID":"ce95b152-d47f-443f-884b-e0b506a215be","Contents": "foo","Name":"mytemplate"}
```
APIは、新しく作成されたテンプレートのGUIDで応答します

## リストテンプレート

ユーザーが利用できるすべてのテンプレートを一覧表示するには、/api/templatesに対してGETを実行します。 結果はテンプレートの配列になります。

[{"GUID":"a8fbdee6-9d92-4d5e-80ab-540532babd54","ThingUUID":"7a4de770-6c31-11e9-b1ef-54e1ad7c66cf","UID":1,"GIDs":[2,3],"Global":false,"Name":"blah","Description":"","Updated":"2019-03-29T10:55:40.127258032-06:00","Contents":"bar"}]

## 単一のテンプレートを取得する

単一のテンプレートを取得するには、GETを実行してください/api/templates/<guid>。

{"GUID":"a8fbdee6-9d92-4d5e-80ab-540532babd54","ThingUUID":"7a4de770-6c31-11e9-b1ef-54e1ad7c66cf","UID":1,"GIDs":[2,3],"Global":false,"Name":"blah","Description":"","Updated":"2019-03-29T10:55:40.127258032-06:00","Contents":"bar"}

## テンプレートを更新する

テンプレートを更新するには、にPUTを実行し/api/templates/<guid>ます。要求本体は、同じパスでGETによって返されるものと同じで、必要な要素が変更されている必要があります。GUIDは変更できないことに注意してください。以下のフィールドのみを変更できます。

* Contents: テンプレートの実際の本体/内容
* Name: テンプレートの名前を変更します
* Description: テンプレートの説明を変更する
* GIDs: 32ビット整数グループIDの配列に設定されるかもしれません、例えば "GIDs":[1,4]
* UID:（管理者のみ）32ビット整数に設定
* Global: （管理者のみ）ブール値のtrueまたはfalseに設定します。グローバルテンプレートはすべてのユーザーに表示されます。

注：これらのフィールドのいずれかを空白のままにすると、テンプレートはそのフィールドのNULL値で更新されます。

## テンプレートを削除する

テンプレートを削除するには、にDELETEリクエストを送信してください/api/templates/<guid>。

## 管理者アクション

管理ユーザーは、システム上のすべてのテンプレート/ピボットを表示したり、それらを変更したり、削除したりする必要がある場合があります。GUIDは必ずしも一意ではないため、管理APIは代わりにGravwellがアイテムを格納するために内部で使用する一意のUUIDを参照する必要があります。上記のテンプレートリストの例には、 "ThingUUID"という名前のフィールドが含まれています。これはそのテンプレートの内部の一意の識別子です。

管理者ユーザーは、GET要求を使用してシステム内のすべてのテンプレートのグローバルリストを取得できます/api/templates?admin=true。

次に、管理者は、PUTを使用して特定のテンプレートを更新/api/templates/<ThingUUID>?admin=trueし、目的のテンプレートをThingUUID値に置き換えます。同じパターンが削除にも適用されます。