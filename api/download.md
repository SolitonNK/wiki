# Downloading search results

各レンダラーは、さまざまな形式の検索結果のダウンロードをサポートしています。たとえば、クエリがテーブルを介してレンダリングされる場合は、結果をcsv、json、またはネイティブルックアップ形式として直接ダウンロードできます。ダウンロード要求がブラウザから来ている場合、ダウンロードを実行することは追加のステップを必要とするかもしれません。クライアントは有効なJWTを使用してWebサーバーに対して認証されている必要があり、ユーザーはそれをダウンロードするために検索にアクセスできる必要があります。ダウンロードリンクは、他のすべてのAPIと同じ標準のJWTトークンスキームを使用して保護されています。

## 検索結果のダウンロード
CSV形式でid 150460229の検索をダウンロードする

```
GET /api/searchctrl/150460229/download/csv
```
## 一時JWTトークンを介してダウンロードにアクセスする

Webブラウザはjavascriptを介してファイルのダウンロードを実行できない（したがって要求ヘッダーを介してJWTを配信できない）ため、検索結果のダウンロードでは "token"という名前のCookieに格納された一時JWTを使用して認証できます。クライアントはない（SHOULD NOT）クライアントができ、一時的なJWTを求める必要がある代わりに、クッキーに通常のJWTトークンを保存ONLY検索結果をダウンロードするために使用すること。これらの一時的なJWTトークンは、ダウンロードAPIのURLへのアクセスを許可するだけで、他のAPIでは使用できません（ヘッダーまたはCookieとして）。一時JWTトークンは3秒間有効です。

ダウンロード要求の一部として追加のヘッダーを配信できる非ブラウザーベースのクライアントは、一時JWTトークンおよびCookieビジネスを無視し、適切な要求ヘッダーで通常のJWTトークンを送信するだけで済みます。サーバーが標準ヘッダーに有効なJWTトークンを見つけた場合、それは認証に使用されます。


### JWT一時トークンの取得

```
GET /api/login/tmptoken:
{
        "LoginStatus": true,
	"JWT": "7b22616c676f223a36323733382c22747970223a226a7774227d.7b22756964223a312c2265787069726573223a22323031382d30362d32305431333a32343a32382e393436393338312d30363a3030222c22696174223a5b3138312c36312c35382c3138352c3139322c3135392c3233302c3130372c37312c33322c3130382c33332c3134362c3138362c37392c35372c35382c33342c3135362c36342c33322c3234372c39352c35352c3138342c3235322c3135312c39382c34322c31382c35312c375d7d.cec81d84a3c96e8fd6961c1113a026eba08344d06d518e65f28bd6b92655fb6a22433fd6e42b51d62d45f8ed2a1665f3f951019b982251ebc614e8be5e4fdb6e"
}

```

ブラウザは、有効期限が3秒の「token」という名前のCookieで、GETリクエストにJWT値を発行する必要があります。CookieはどのAPIについても尊重されていませんが、検索結果をダウンロードしています。