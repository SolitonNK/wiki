# User Files

ユーザーファイルAPIは、キットが小さなアイコンをアイコンとして使用するために保存できるように設計されています。

ユーザーファイルはGUIDによって参照されます。GUIDはシステム全体で必ずしも一意ではありません。これにより、ユーザーはたとえばGUIDで特定のファイルを参照するダッシュボードを持つことができますが、各ユーザーは自分の好みのファイルをインストールできます。同じGUIDを持つ複数のテンプレートまたはピボットが存在する場合、それらは次の順序で優先順位が付けられます。

* ユーザー所有
* ユーザーがメンバーになっているグループと共有
* グローバル

 各ファイルには、Gravwellによってストレージに使用される固有のUUIDがあります。以下に記載されているadmin APIを使用すると、管理者は自分の "ThingUUID"を参照してユーザーファイルを管理できます。

## ユーザーファイルを作成する

ユーザーファイルはへのPOSTリクエストで作成できます/api/files。リクエストは、次のフィールドを持つマルチパートリクエストです。

* `file`: ファイルの本体
* `name`: ファイルの名前
* `desc`: ファイルの説明
* `guid`: （オプション）このファイルに必要なGUID 設定されていない場合は、1が生成されます。

## ファイルのリスト

ユーザーファイルはGET onによって一覧表示され/api/filesます。結果はファイル情報を含む構造体の配列です。

```
[
	{
		"GUID": "1945c39e-0bd1-40cf-b069-6da64d3f8afe",
		"ThingUUID": "3525901f-5723-11e9-be65-54e1ad7c66cf",
		"UID": 1,
		"GIDs": null,
		"Global": false,
		"Size": 99,
		"Type": "text/plain; charset=utf-8",
		"Name": "blah",
		"Desc": "bar",
		"Updated": "2019-04-04T15:50:19.290186504-06:00"
	}
]
```

## ファイルの内容を読む

ファイルの内容は/api/files/<uuid>、たとえば上記のリストのファイルを読み取るためのGET要求によって読み取ることができます/api/files/1945c39e-0bd1-40cf-b069-6da64d3f8afe。

## ファイルを更新する

ファイルの名前、説明、および内容は、POSTリクエストを介してに変更できます/api/files/<uuid>。要求がで、新しいファイルを作成するために使用されるものと同一であるべきでfile、nameおよびdesc所望の値に設定するフィールド。このguidフィールドは無視されます。

## ファイルを削除する

ユーザーファイルは、DELETEによって削除されます。 /api/files/<uuid>

## 管理者アクション

管理者ユーザーは、システム上のすべてのユーザーファイルを表示したり、変更したり、削除したりする必要がある場合があります。GUIDは必ずしも一意ではないため、管理APIは代わりにGravwellがアイテムを格納するために内部で使用する一意のUUIDを参照する必要があります。上記のファイルリストの例には、 "ThingUUID"という名前のフィールドが含まれています。これは、そのユーザーファイルの内部の一意の識別子です。

管理者ユーザーは、GET要求を使用してシステム内のすべてのユーザーファイルのグローバルリストを取得できます/api/templates?admin=true。

管理者はDELETEメッセージを使用して特定のファイルを削除/api/files/<ThingUUID>?admin=trueし、目的のファイルのThingUUID値を代入することができます。同じパターンが更新にも適用されます。