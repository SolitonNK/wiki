# システムマネジメント

このページでは、Gravwellプロセスと構成を管理するための管理者専用APIについて説明します。

## Gravwellの再起動

Gravwellプロセスを再起動するために2つのAPIが提供されています。 1つはWebサーバーを再起動し、もう1つはインデクサーを再起動します。どちらの場合も、「再起動」は、プロセスをシャットダウンし、systemd（または使用中のinitシステム）がプロセスを再起動できるようにすることで実行されます。

### Webサーバーを再起動します

ウェブサーバーを再起動するには、本文が空のPOSTリクエストを`/api/restart/webserver`に送信します。これにより、Webサーバーがシャットダウンし、すぐに再起動します。

### インデクサーの再起動

ウェブサーバーが現在接続されているすべてのインデクサーを再起動するには、本文が空のPOSTリクエストを`/api/restart/indexers`に送信します。 Webサーバーは、各インデクサーに、自身をシャットダウンして再起動する必要があることを通知します。個々のインデクサーが復旧すると、Webサーバーは自動的に再接続します。

### 分散フロントエンドと展開情報の確認

Gravwellクラスターが分散フロントエンドモードで動作しているかどうかを確認するには、`/api/deployment`でGETを実行します。 Webサーバーは、フロントエンドが分散モードで構成されているかどうかを示すJSONオブジェクトで応答します。

分散モードでない場合の応答例：

```
{
	"Distributed": false,
	"DefaultLanguage": "en_US",
}
```

### システムバックアップの実行

管理ユーザーは、Gravwellの状態に関連するすべてのコンテンツを含むバックアップファイルを提供するシステムバックアップを要求できます。

システムバックアップを使用して、ユーザーアカウントとグループアカウント、ダッシュボード、キット、クエリライブラリ、さらには保存された検索を保存できます。 これは基本的に、データとシステム構成以外のすべてです。

管理ユーザーとして`/api/backup`に対して`GET`リクエストを実行することでバックアップが取得され、APIはバックアップファイルを含むファイルのダウンロードを返します。

デフォルトでは、バックアップには保存された検索は含まれません。 保存された検索をバックアップに含めるには、GETリクエストに `savedsearch = true`URLパラメータを追加します。

`/api/backup`APIは、JWT認証トークンまたはCookieのいずれかを使用して認証できます。

注：一度に実行できるバックアップおよび/または復元は1つだけです。

### システムバックアップからの復元

管理ユーザーは、`/api/backup`APIに対して`POST`を実行し、マルチパートフォームを使用してバックアップファイルをアップロードすることにより、バックアップアーカイブからシステムを復元できます。

APIは、バックアップファイルが `backup`フォームフィールドにあり、マルチパートフォームを使用してアップロードされることを想定しています。

`/api/backup` APIは、JWT認証トークンまたはCookieのいずれかを使用して認証できます。

注：復元は完全な復元であり、ユーザー、コンテンツ、または保存された検索への変更は、復元ポイントが失われた後に行われます。

注：一度に実行できるバックアップおよび/または復元は1つだけです。

注：復元が開始されると、すべてのセッションが終了します。 復元が正常に完了すると、すべてのユーザーが再度ログインする必要があります。