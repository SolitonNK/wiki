# Gravwellで検索

Gravwellは可読データ湖であり、パイプラインを探索することがこの機能の中心となっています。 これは、プラットフォームのパワーと柔軟性を、収集する前に知る必要のないデータに関する情報と見なすことができるということです。 その代わりに、生データを取り込み、検索処理パイプを組み立てて、生データを操作可能な結果に変換することができます！ これは、SIEMsの一般的な問題である特定の金型を試して適合させるための標準化またはマッサージデータをほとんど排除します。 また、新しい情報や技術が利用可能になった場合には、古いデータを遡って分析してみましょう。

パイプの検索はGravwell機能の中核であり、Linux/Unixコマンドラインと同様に動作します。 Gravwell Search Query構文は、生データを検索して結果に変換するための処理パイプラインを組み立てます。 パイプラインモジュールは、典型的には、少なくとも1つの抽出モジュール、1つ以上のフィルタリングまたは処理モジュール、およびレンダリングモジュールから構成される。 たとえば、次のクエリーは、redditというラベルのデータを取得し、jsonモジュールを使用してBodyという名前のフィールドを抽出し、evalモジュールを使用して20文字を超えるBodyフィールドのエントリをフィルタリングし、最後にテーブルレンダラを使用してBodyフィールドの内容を表示します:

```
tag=reddit json Body | eval len(Body) < 20 | table Body
```

クエリを実行するために使用されるユーザーインターフェイスドキュメントは[ここ](#!gui/queries/queries.md)にあります。

## クエリの構成要素

上記の例示的なクエリは、以下に説明するように、いくつかの個別の部分に分割することができます。

### タグ指定

Gravwellクエリの最初の部分は、タグの指定です。ユーザーは、1つ以上のタグを指定しなければならず、そこからインデクサーがデータを引き出してパイプラインの開始に投入する必要があります。以下の例では、"reddit "というタグが付けられたデータを取得するようにGravwellに指示しています。

```
tag=reddit
```

複数のタグを指定することもできます:

```
tag=reddit,hackernews
```

ワイルドカードを使うこともできます:

```
tag=syslog-http-*,syslog-firewall-*
```

### 抽出モジュール

抽出モジュールは、生の基礎データからフィールド/値/プロパティを引き出すために使用されます。

```
tag=reddit json Body | eval len(Body) < 20 | table Body
```

上の例では、`JSON`モジュールは生のJSONテキストから値を抽出し、パイプラインのさらに下のモジュールに「列挙された値」として提供しています。言い換えれば、このモジュールはJSONを解析し、データを構造体として提供します。json Body` の例では、生の JSON テキストから単一の値を抽出しています。

これらのモジュールの完全なドキュメントは、[Extration Modules](extractationmodules.md)にあります。

### 検索モジュール

検索モジュールは、データエントリを分析したり、望ましくないデータをフィルタリングしたり、データの興味深い部分を抽出したりするために使用される。検索パイプラインは、前のモジュールの結果に基づいて動作する多数の検索モジュールを次々に含むことができます。

上の例では、`eval` は処理やフィルタリングを行う検索モジュールである。多くの検索モジュールは、モジュールの呼び出しの前に*additional*タグを指定することで、全体のクエリタグのサブセットを操作することができることに注意してください。これは、初期の抽出を別の方法で行う必要がある場合に非常に便利です。

```
tag=reddit,hackernews tag=reddit json Body | tag=hackernews json body as Body | eval len(Body) < 20 | table Body
```

検索モジュールの完全なドキュメントは[こちら](searchmodules.md)


### レンダーモジュール

レンダリング モジュールは、検索モジュールによって生成された結果を取得し、ユーザーにグラフィカルに表示します。検索パイプラインには、パイプラインの最後に1つのレンダーモジュールのみが含まれます。

```
tag=reddit json Body | eval len(Body) < 20 | table Body
```

上記の例では、「table」はレンダリングモジュールです、 Body列挙値の内容を列に表示するように指示されます。


レンダーモジュールの完全なドキュメントは[ここ](rendermodules.md)をクリックしてください


## 列挙値

列挙値は、検索パイプライン内で作成され使用される特殊なデータ要素です。以下のパイプラインでは、いくつかの列挙値が作成されています。

```
tag=reddit json Body | langfind -e Body | count by lang | sort by count desc | table lang count
```

まず、jsonモジュールは生のエントリのJSONを解析して "Body "要素を取り出し、`Body`という名前の列挙値に格納します。次にlangfindモジュールが `Body` の列挙値にアクセスし、使用されている言語の解析を試みます; その結果を `lang` という新しい列挙値に格納します。次に、countモジュールは `lang` 列挙値を読み込み、それぞれの値が何回出現したかを数え、その結果を `count` という名前の列挙値に格納します。パイプラインの残りの部分はカウントに基づいて結果をソートし、`lang`と`count`の列挙値からテーブルを作成します。

ドキュメント全体のさらなる例は、列挙値の使用を明確にするのに役立つはずです。

## フィルタリング

Gravwell抽出モジュールは、通常、抽出時に*extracted*アイテムを*filtered* できるようにします。フィルタリングでは、特定の基準に一致するかどうかに基づいてエントリをドロップまたはパスすることができます。

## 引用とトークン化

Gravwell モジュールに引数を指定するときは、特殊文字に注意してください。ほとんどのモジュールでは、スペース、タブ、改行、以下の文字を区切り文字として扱います。!#$%&'()*+,-./:;<=>?@

これらの文字を含むモジュールへの引数を指定する場合は、ダブルクォートで括ってください。

```
json "search-id"
```

```
grep "dank memes"
```

ダブルクォーテーション文字を使用する必要がある場合は、ダブルクォーテーション文字をエスケープすることができます。

```
grep "\","
```

## マクロ

マクロは、長くて複雑なクエリを覚えやすいショートカットに変えるのに役立ちます。詳細は [完全なマクロドキュメント](#!search/macros.md) を参照してください。

## コメント

クエリは、クエリテキスト内の任意の場所にC-Styleコメントをサポートしています。コメントは検索履歴に保存され、クエリのデバッグやインラインでのメモの追加に便利です。例えば、以下のようになります。

```
tag=foo json foo.bar /* a c-style comment that has no impact on the search */ baz | table
```

