## words

wordsは、分割文字で区切られたテキスト単語を検索するシンプルなテキストマッチングエンジンです。 words モジュールは機能的には `grep -s -w` と同等であり、フルテキストアクセラレータと相互作用するように設計されています。 words は UTF8 文字エンコーディングをサポートしており、通常はバイナリデータでも問題なく動作します。 しかし、words モジュールがどのようにして単語の境界を破るのかを理解することが重要です。 バイナリデータストリームのバイト 0x44 に単語 `foo` が隣接している場合、 words モジュールはその単語を `Dfoo` として識別し、クエリ用語 `foo` にはマッチしません。 wordsは未知のデータを扱う際の最初のレベルのフィルタとして最適です。

wordsモジュールはワイルドカードをサポートしていません。 ワイルドカードをサポートした単語のマッチングが必要な場合は、`-w` フラグを使って [grep](../grep/grep.md) モジュールをチェックしてください。

`words` モジュールでは複数のパターンを指定することができ、デフォルトは厳格モードとなっています。`any` マッチング動作が必要な場合は、`-or` フラグを指定することで、一致する単語があればそのエントリをパイプラインに渡すことができます。`words` モジュールは、単語を含まないエントリを検索できるように、反転ロジックもサポートしています。

### サポートされているオプション

* `-v`: 逆のマッチです。例えば、`words -v bar`は「bar」という単語を含むレコードをすべて削除し、「bar」という単語を含まないレコードを渡します。
* `-e <arg>`: レコード全体ではなく、列挙された値に対して操作します。例えば、HTTPテキストを含むがポート80に対応していないパケットを表示するパイプラインは、`tag=pcap packet ipv4.DstPort!=80 tcp.Payload | words -e Payload GET HTTP 1.1"`のようになります。
* `-or`: 一致するものがあれば、エントリを渡します。 パターンにマッチするものがあればエントリを渡し、否定フラグと組み合わせることで、単語が欠落しているエントリはすべて削除されます。

### パラメータの構造
```
words <argument list> <search parameter>
```

### 検索例

`Mozilla` と `Firefox` という単語を含む Apache のログを探すには、以下のようにします。

```
tag=apache words Mozilla Firefox
```

ペイロードに HTTP や 1.1 という単語が含まれていない 80 番ポート向けのパケットを見つけるには、以下のようにします。

```
tag=pcap packet tcp.Port==80 tcp.Payload | words -e Payload -v HTTP 1.1
```

次のようにすると、`Gravwell`や`gravwell`を含むRedditの投稿にマッチします。

```
tag=reddit json Body | words -e Body -or Gravwell gravwell
```

Mozilla と Windows を含むユーザーエージェントのみを取得：

```
tag=apache words Mozilla Windows
```

### 単語一致システムを使った作業

単語一致システムは、完全な単語に一致するように設計されています。 wordsは、値を選択する際に、さらに特殊性を持たせるように設計されています。

```
16.246.30.72 - - [08/May/2017:15:20:35 -0600] "DELETE /search/tag/list HTTP/1.0" 200 5032 "http://nguyen.biz/category/tags/tag/home.htm" "Opera/8.74.(Windows 98; Win 9x 4.90; it-IT) Presto/2.9.173 Version/11.00"
```

何がマッチするのか、しないのかを確認するために、`words` の呼び出しをいくつか見てみましょう。

| Words Invocation | MATCHES | 説明 |
|-----------------|---------|-------------|
| words Ver       |   NO    | Verは完全な単語ではないので、モジュールの単語は `Version/11.00` パターンとは一致しません |
| words 16.246.30.72   |   YES    | ピリオドは境界線の区切り文字ではないので、単語はIPと一致します |
| words 8.74   |   YES    | 単語 "8.74" に末尾の "." 文字があっても、単語は "8.74" の値に一致します。 これは、「.」文字はトリム文字とみなされ、マッチから削除されるためです。 これは、（「.」や「,」、「;」のような）句読点が使われているときに自然言語の単語にマッチするようにするためです |
| words Version   |   YES   | モジュールの単語は、Version が完全な単語であり、`/` 文字は分割文字であるために一致します |
| words 11.00     |   YES     | 単語はマッチしますが、`.` 文字はスペースが続く場合はセパレータのみで、これにより IP アドレスをマッチさせることができます |
| words "Version/11.00"   |  ERROR  | words モジュールはエラーをスローします |
| words "Ver*"   |  NO  | マッチしません。というのも、words モジュールは "*"文字をワイルドカードとして扱わず、完全な単語 "Ver*"を探しているからです |
