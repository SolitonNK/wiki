## Words

Wordsは、分割文字で区切られたテキストワードを検索する単純なテキストマッチングエンジンです。 wordsモジュールは機能的には`grep -s -w`と同等であり、フルテキストアクセラレータと対話するように設計されています。 WordsはUTF8文字エンコードをサポートしており、通常はバイナリデータで適切に動作します。つまり、pcapストリームで"foo"という単語を検索することができます。ただし、単語モジュールが単語の境界でどのように分割されるかを理解することが重要です。バイナリデータストリームで単語"foo"がバイト0x44に隣接している場合、wordsモジュールはその単語を`Dfoo`として識別し、クエリ用語`foo`と一致しません。 Wordsは、未知のデータを操作する場合の優れた第1レベルのフィルターです。

wordsモジュールはワイルドカードをサポートしていません。ワイルドカードサポートとの単語マッチングが必要な場合は、-gフラグを使用して[grep](../grep/grep.md)モジュールをチェックアウトしてください。

`words`モジュールでは複数のパターンを指定でき、デフォルトは厳格モードに設定されています。つまり、エントリがピップラインに渡されるには、すべてのパターンが一致する必要があります。一致する動作が必要な場合、`-or`フラグは、単語がエントリに一致する場合にパイプラインに渡されることを指定します。`words`モジュールは逆論理もサポートしているため、単語を含まないエントリを検索できます。

### サポートされているオプション

* `-v`: “Inverse”マッチ。たとえば、`words -v bar`は、単語“bar”を含むすべてのレコードを削除し、“bar”という単語を含まないレコードを渡します。複数の単語が指定されている場合、すべての単語がエントリに存在してはなりません。
* `-e <arg>`: レコード全体ではなく列挙値を操作します。たとえば、HTTPテキストを含むがポート80宛てではないパケットを示したパイプラインは、`tag=pcap packet ipv4.DstPort!=80 tcp.Payload | words -e Payload GET HTTP 1.1"`
* `-or`: 任意の一致。一致するパターンがエントリを渡す場合、否定フラグと組み合わせると、単語が欠落しているエントリがすべて削除されます。

### パラメータ構造
```
words <argument list> <search parameter>
```

### 検索例

`Mozilla`および`Firefox`という単語を含むApacheログを検索するには

```
tag=apache words Mozilla Firefox
```

ペイロードにHTTPまたは1.1という単語が含まれていないポート80宛てのパケットを見つけるには:

```
tag=pcap packet tcp.Port==80 tcp.Payload | words -e Payload -v HTTP 1.1
```

`Gravwell`または`gravwell`という単語を含むRedditの投稿に一致:

```
tag=reddit json Body | words -e Body -or Gravwell gravwell
```

MozillaおよびWindowsを含むユーザーエージェントのみを取得する

```
tag=apache words Mozilla Windows
```

### 単語一致の使用

単語照合システムは、完全な単語を照合するように設計されています。 Wordsは、値を選択するときにいくつかの追加の特異性を作成するように設計されています。いくつかのサンプルデータを見て、一致するものとしないものを確認してください。

```
16.246.30.72 - - [08/May/2017:15:20:35 -0600] "DELETE /search/tag/list HTTP/1.0" 200 5032 "http://nguyen.biz/category/tags/tag/home.htm" "Opera/8.74.(Windows 98; Win 9x 4.90; it-IT) Presto/2.9.173 Version/11.00"
```

`words`の呼び出しをいくつか見て、一致するものと一致しないものを見てみましょう:

| Wordsの呼び出し | 一致 | 説明 |
|-----------------|---------|-------------|
| words Ver       |   NO    | Verは完全な単語ではないため、wordsモジュールは `Version / 11.00`パターンと一致しません。 |
| words 16.246.30.72   |   YES    | "."はIPアドレスに一致します。文字は境界区切り文字ではありません |
| words 8.74   |   YES    | 単語"8.74"の末尾に"."の文字があっても、単語は"8.74"の値と一致します。"."文字はトリム文字と見なされ、一致から削除されます。これは、句読点が使用されているときに自然言語の単語と一致できるようにするためです（"."、","、";"など）。 |
| words Version   |   YES   | Versionは完全な単語であり、 `/`文字は分割文字であるため、単語モジュールは一致します |
| words 11.00     |   YES     | 語は一致します。`.`文字の後にスペースが続く場合は区切り文字にすぎません。これにより、IPアドレスの一致が許可されます。 |
| words "Version/11.00"   |  ERROR  | wordsモジュールはエラーをスローします。マッチに単語境界文字を含めることはできません。 |
| words "Ver*"   |  NO  | wordsモジュールは"*"文字をワイルドカードとして扱わず、完全な単語"Ver *"を探しているため、wordsモジュールは一致しません。 |
